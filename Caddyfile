{$DOMAIN}, www.{$DOMAIN} {
 root * /app/public

 # Layani file statis dulu
 file_server

 # PHP/FrankenPHP handler
 php_server

 encode gzip zstd

 # Security headers
 header {
 X-Content-Type-Options "nosniff"
 X-Frame-Options "SAMEORIGIN"
 Referrer-Policy "no-referrer-when-downgrade"
 X-XSS-Protection "1; mode=block"
 # Sesuaikan CSP kalau ada font/CDN eksternal
 Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data:;"
 Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
 }

 # Block akses ke file sensitif
 @sensitive {
 path /.env
 path /wp-config.php
 path /wp-config-sample.php
 path /readme.html
 path /license.txt
 }
 respond @sensitive 404

 # Deny direct access ke PHP di uploads
 @uploads_php path_regexp uploads_php ^/wp-content/uploads/.*\.php$
 respond @uploads_php 404

 # Optional: blokir xmlrpc kalau tidak dipakai
 @xmlrpc path /xmlrpc.php
 respond @xmlrpc 403
}
